<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sunny’s RECASCADANATOR?!?!</title>

<style>
  body {
    background: #2b2b2b;
    color: #eaeaea;
    font-family: system-ui, sans-serif;
    margin: 0;
  }

  .page {
    display: flex;
    gap: 36px;
    padding: 20px;
    align-items: flex-start;
  }

  .main {
    flex: 1;
  }

  .sidebar img {
    max-width: 320px;
    height: auto;
    display: block;
    opacity: 0.95;
  }

  h1 {
    font-size: 1.8rem;
    margin-bottom: 12px;
    font-weight: 600;
  }

  .info-box {
    background: #1e1e1e;
    border: 1px solid #444;
    padding: 12px 14px;
    margin-bottom: 18px;
    font-size: 0.85rem;
    line-height: 1.5;
    color: #cfcfcf;
  }

  .label {
    margin: 12px 0 4px;
    font-weight: 600;
  }

  textarea {
    width: 100%;
    height: 240px;
    background: #1e1e1e;
    color: #eaeaea;
    border: 1px solid #444;
    padding: 10px;
    box-sizing: border-box;
    font-family: monospace;
    margin-bottom: 12px;
  }

  button {
    padding: 8px 14px;
    background: #444;
    color: #eaeaea;
    border: 1px solid #666;
    cursor: pointer;
    margin-right: 8px;
  }

  button:hover {
    background: #555;
  }

  @media (max-width: 768px) {
    .page {
      flex-direction: column;
    }

    .sidebar {
      display: flex;
      justify-content: center;
      margin-top: 28px;
    }

    .sidebar img {
      max-width: 240px;
    }
  }
</style>
</head>

<body>

<div class="page">

  <div class="main">

    <h1>Sunny’s RECASCADANATOR?!?!</h1>

    <div class="info-box">
      This is for <strong>REMOVING WRAPPING</strong> intended to stop cascade<br>
      - Maybe you're like me and forget to backup your shit and you need to undo the cascade tool<br>
      - paste your wrapped lorebook json<br>
      - this tool will remove all underscores. Underscores between two connected words (Hello_you) will be replaced by a space!<br>
      &lt;3
    </div>

    <div class="label">Input Lorebook JSON (wrapped)</div>
    <textarea id="input"></textarea>

    <button onclick="process()">Remove Underscores</button>

    <div class="label">Output JSON</div>
    <textarea id="output"></textarea>

    <button onclick="copyOutput()">Copy Output</button>

  </div>

  <div class="sidebar">
    <img src="https://i.imgur.com/yeSYFNZ.png" alt="Sunflower seeds artwork">
  </div>

</div>

<script>
/*
BEHAVIOR SUMMARY (LOCKED):

- Only modifies entries[].description
- "_" between two word characters becomes a space
- All remaining "_" characters are removed
- No trigger logic
- No casing changes
- No normalization beyond spacing
*/

function process() {
  let data;

  try {
    data = JSON.parse(document.getElementById("input").value);
  } catch {
    alert("Invalid JSON");
    return;
  }

  if (!Array.isArray(data.entries)) {
    alert("Invalid lorebook format");
    return;
  }

  data.entries.forEach(entry => {
    if (typeof entry.description === "string") {
      let text = entry.description;

      // Step 1: underscore between word characters → space
      text = text.replace(/([A-Za-z0-9])_([A-Za-z0-9])/g, "$1 $2");

      // Step 2: remove all remaining underscores
      text = text.replace(/_/g, "");

      entry.description = text;
    }
  });

  document.getElementById("output").value =
    JSON.stringify(data, null, 2);
}

function copyOutput() {
  const out = document.getElementById("output");
  out.select();
  document.execCommand("copy");
}
</script>

</body>
</html>
